(this["webpackJsonprealtime-multi-player"]=this["webpackJsonprealtime-multi-player"]||[]).push([[0],{113:function(t,n,e){},114:function(t,n,e){},230:function(t,n,e){"use strict";e.r(n);var o,c=e(0),i=e.n(c),r=e(26),a=e.n(r),s=(e(113),e(114),e(5)),u=e(34),d=e.n(u),l=e(68),f=e(18),h=e(97),p=e(105),O=e(247),v=e(7),j=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).SERVER_ADDR||"letsdrawtogether.net",S=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).WEBSOCKET_ENDPOINT||"websockettest",b=JSON.stringify({action:"CLEAR",topic:x}),w=window.innerWidth-15,m=window.innerHeight-160,E="black",g=!1,C=null,x="",R=(new Set,new Set),T=new Set,_=!1,y=function(){k();var t="wss://".concat(j,"/").concat(S);console.log("Attempting to connect to websocket on: ".concat(t)),(C=new WebSocket(t)).onopen=function(){console.log("WebSocket Client Connected")},C.onmessage=function(t){var n=JSON.parse(t.data);n.topic===x&&("CLEAR"===(null===n||void 0===n?void 0:n.action)?(R.clear(),_=!0):void 0!==(null===n||void 0===n?void 0:n.type)&&T.add(n))}},D=function(t,n){var e=t.getBoundingClientRect(),o=n.clientX-e.left,c=n.clientY-e.top,i={topic:x,type:"CIRCLE",color:E,radius:2,posX:o,posY:c};C.send(JSON.stringify(i))},L=function(t){_&&(A(t),_=!1),Array.from(T).map((function(n){!function(t){var n=t.ctx,e=t.posX,o=t.posY,c=t.radius,i=t.color;n.beginPath(),n.arc(e,o,c,0,2*Math.PI),n.fillStyle=i,n.fill(),n.strokeStyle=i,n.stroke()}(Object(h.a)({ctx:t},n))})),R=new Set([].concat(Object(f.a)(R),Object(f.a)(T))),T=new Set},A=function(t){t.fillStyle="white",t.fillRect(0,0,o.width,o.height)},W=function(){C.send(b)},k=function(){var t="https://letsdrawtogether.net/api/canvasState?roomId=".concat(x);fetch(t,{method:"GET"}).then((function(t){return t.json()})).then((function(t){R=new Set(t)}))},I=function(t,n){g=!1},N=function(t){var n,e=t.match,i=(t.location,Object(c.useRef)());void 0!==(null===e||void 0===e||null===(n=e.params)||void 0===n?void 0:n.roomId)&&(x=e.params.roomId),b=JSON.stringify({action:"CLEAR",topic:x});var r=function(t,n,e){t.width=n,t.height=e,w=n,m=e};window.addEventListener("resize",r,!1);return Object(c.useEffect)(Object(l.a)(d.a.mark((function t(){var n,e;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return y(),(o=i.current).addEventListener("mousedown",(function(t){return D(o,t)})),e=function(){var t=Object(l.a)(d.a.mark((function t(){var c,i,a;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:c=window.innerWidth-15,i=window.innerHeight-160,r(o,c,i),a=o.getContext("2d"),L(a),n=requestAnimationFrame(e);case 6:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),t.next=6,e();case 6:return t.abrupt("return",(function(){cancelAnimationFrame(n)}));case 7:case"end":return t.stop()}}),t)})))),Object(v.jsxs)("div",{children:[Object(v.jsx)("div",{children:"created by Rich White"}),Object(v.jsx)(O.a,{onClick:W,children:"Clear Canvas"}),Object(v.jsx)("canvas",{ref:i,width:w,height:m,onMouseDown:function(t){return function(t,n){D(t,n),g=!0}(o,t)},onMouseMove:function(t){return function(t,n){g&&D(t,n)}(o,t)},onMouseUp:function(t){return I()},onMouseLeave:function(t){return I()}}),Object(v.jsx)(p.a,{onChange:function(t,n){E=t.hex}})]})},P=e(249),F=function(){return Object(v.jsx)(P.a,{children:"Lets Draw Together! - created by Rich White"})},H=function(){return Object(v.jsxs)("div",{className:"App",children:[Object(v.jsx)(F,{}),Object(v.jsx)(s.a,{exact:!0,path:"/",component:N}),Object(v.jsx)(s.a,{path:"/room/:roomId",component:N})]})},K=function(t){t&&t instanceof Function&&e.e(3).then(e.bind(null,250)).then((function(n){var e=n.getCLS,o=n.getFID,c=n.getFCP,i=n.getLCP,r=n.getTTFB;e(t),o(t),c(t),i(t),r(t)}))},M=e(67),B=e(248);a.a.render(Object(v.jsx)(i.a.StrictMode,{children:Object(v.jsx)(M.a,{children:Object(v.jsx)(B.a,{children:Object(v.jsx)(H,{})})})}),document.getElementById("root")),K()}},[[230,1,2]]]);
//# sourceMappingURL=main.05a1a4dc.chunk.js.map