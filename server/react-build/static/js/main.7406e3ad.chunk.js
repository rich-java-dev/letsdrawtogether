(this["webpackJsonprealtime-multi-player"]=this["webpackJsonprealtime-multi-player"]||[]).push([[0],{113:function(t,n,e){},114:function(t,n,e){},230:function(t,n,e){"use strict";e.r(n);var o,c=e(0),r=e.n(c),i=e(27),a=e.n(i),u=(e(113),e(114),e(5)),s=e(19),l=e(97),d=e(14),f=e.n(d),p=e(30),h=e(105),v=e(247),O=e(7),w=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).SERVER_ADDR||"letsdrawtogether.net",j=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).WEBSOCKET_ENDPOINT||"websockettest",S=JSON.stringify({action:"CLEAR",topic:x}),b=window.innerWidth-15,m=window.innerHeight-160,C="black",g=!1,E=null,x="",T=(new Set,new Set),R=new Set,y=!1,_=0,k=0,L=function(){I();var t="wss://".concat(w,"/").concat(j);console.log("Attempting to connect to websocket on: ".concat(t)),(E=new WebSocket(t)).onopen=function(){console.log("WebSocket Client Connected")},E.onmessage=function(t){var n=JSON.parse(t.data);n.topic===x&&(void 0!==(null===n||void 0===n?void 0:n.type)?R.add(n):"CLEAR"===(null===n||void 0===n?void 0:n.action)&&(T.clear(),y=!0,console.log("Clear called")))}},D=function(){var t=Object(p.a)(f.a.mark((function t(n,e){var o,c,r,i,a,u,s,l,d;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=n.getBoundingClientRect(),c=Math.floor(e.clientX-o.left),r=Math.floor(e.clientY-o.top),i={topic:x,type:"CIRCLE",color:C,radius:2,posX:c,posY:r},E.send(JSON.stringify(i)),g&&_>0&&k>0&&(a=Math.sqrt(Math.pow(c-_,2)+Math.pow(r-k,2)))>4)for((r-k)/(c-_),u=(c-_)/a,s=(r-k)/a,l=1;l<=a;l++)d={topic:x,type:"CIRCLE",color:C,radius:2,posX:_+l*u,posY:k+l*s},E.send(JSON.stringify(d));_=c,k=r;case 8:case"end":return t.stop()}}),t)})));return function(n,e){return t.apply(this,arguments)}}(),A=function(t){y&&(console.log("Clear Canvas"),M(t),y=!1),Array.from(R).map((function(n){!function(t){var n=t.ctx,e=t.posX,o=t.posY,c=t.radius,r=t.color;n.beginPath(),n.arc(e,o,c,0,2*Math.PI),n.fillStyle=r,n.fill(),n.strokeStyle=r,n.stroke()}(Object(l.a)({ctx:t},n))})),T=new Set([].concat(Object(s.a)(T),Object(s.a)(R))),R=new Set},M=function(t){console.log("Clear Canvas called"),t.fillStyle="white",t.fillRect(0,0,o.width,o.height)},W=function(){E.send(S)},I=function(){var t="https://letsdrawtogether.net/api/canvasState?roomId=".concat(x);fetch(t,{method:"GET"}).then((function(t){return t.json()})).then((function(t){R=new Set(t)}))},N=function(){var t=Object(p.a)(f.a.mark((function t(n,e){return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:D(n,e),g=!0;case 2:case"end":return t.stop()}}),t)})));return function(n,e){return t.apply(this,arguments)}}(),P=function(){var t=Object(p.a)(f.a.mark((function t(n,e){return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:g&&D(n,e);case 1:case"end":return t.stop()}}),t)})));return function(n,e){return t.apply(this,arguments)}}(),F=function(t,n){g=!1,_=0,k=0},H=function(t){var n,e=t.match,r=(t.location,Object(c.useRef)());void 0!==(null===e||void 0===e||null===(n=e.params)||void 0===n?void 0:n.roomId)&&(x=e.params.roomId),S=JSON.stringify({action:"CLEAR",topic:x});window.addEventListener("resize",(function(t,n,e){t.width=n,t.height=e,b=n,m=e}),!1);return Object(c.useEffect)(Object(p.a)(f.a.mark((function t(){var n,e;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return L(),(o=r.current).addEventListener("mousedown",(function(t){return D(o,t)})),e=function(){var t=Object(p.a)(f.a.mark((function t(){var c;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:window.innerWidth-15,window.innerHeight-160,c=o.getContext("2d"),A(c),n=requestAnimationFrame(e);case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),t.next=6,e();case 6:return t.abrupt("return",(function(){cancelAnimationFrame(n)}));case 7:case"end":return t.stop()}}),t)})))),Object(O.jsxs)("div",{children:[Object(O.jsx)("div",{children:"created by Rich White"}),Object(O.jsx)(v.a,{onClick:W,children:"Clear Canvas"}),Object(O.jsx)("canvas",{ref:r,width:b,height:m,onMouseDown:function(t){return N(o,t)},onTouchStart:function(t){return N(o,t)},onMouseMove:function(t){return P(o,t)},onTouchMove:function(t){return P(o,t)},onTouchEnd:function(t){return F()},onMouseUp:function(t){return F()},onMouseLeave:function(t){return F()}}),Object(O.jsx)(h.a,{onChange:function(t,n){C=t.hex}})]})},J=e(249),K=function(){return Object(O.jsx)(J.a,{children:"Lets Draw Together! - created by Rich White"})},B=function(){return Object(O.jsxs)("div",{className:"App",children:[Object(O.jsx)(K,{}),Object(O.jsx)(u.a,{exact:!0,path:"/",component:H}),Object(O.jsx)(u.a,{path:"/room/:roomId",component:H})]})},U=function(t){t&&t instanceof Function&&e.e(3).then(e.bind(null,250)).then((function(n){var e=n.getCLS,o=n.getFID,c=n.getFCP,r=n.getLCP,i=n.getTTFB;e(t),o(t),c(t),r(t),i(t)}))},X=e(68),Y=e(248);a.a.render(Object(O.jsx)(r.a.StrictMode,{children:Object(O.jsx)(X.a,{children:Object(O.jsx)(Y.a,{children:Object(O.jsx)(B,{})})})}),document.getElementById("root")),U()}},[[230,1,2]]]);
//# sourceMappingURL=main.7406e3ad.chunk.js.map